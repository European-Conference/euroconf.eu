<!-- schedule_slot.html is summoned by schedule_day.html. This part of the code adds the time for each slot in the schedule. It then loops through the events under each slot in config.yaml to create a list of speakers ($speakerLinks) for each panel. Once all the speakers for a panel are gathered, the code then calls the final partial schedule_slot.html.--> 
<div class="schedule-slot">
  <span class="time"> {{ .slot.time }} </span>
  <div class="schedule-events">
    {{ range .slot.events }}
      {{$speakerLinks := slice}}

<!-- This section looks for speakers whose first panel parameter (Params.panel) matches a given panel code (.code) in config.yaml -->
      {{ $pages := (where $.root.Site.RegularPages "Section" "speakers") }} 
      {{ $bridge := (where $pages "Params.panel" .code) }}
      {{ $speakers := (where $bridge "Params.moderator" "!=" true) }}
      {{ range $speakers}}
        {{ if eq .Params.show true }}
          {{ $speakerLinks = $speakerLinks | append (printf "<a href='%s'>%s</a>" .RelPermalink .Params.name) }}
        {{ else }}
          {{ $speakerLinks = $speakerLinks | append (printf "%s" .Params.name) }}
        {{end}}
      {{end}}

<!-- This section looks for speakers whose second panel parameter (Params.panel_two) matches a given panel code (.code) in config.yaml -->
      {{ $pagesTwo := (where $pages "Params.panel_two" "!=" nil) }} 
      {{ $bridgeTwo := (where $pagesTwo "Params.panel_two" .code) }}
      {{ $speakersTwo := (where $bridgeTwo "Params.moderator" "!=" true) }}
      {{ range $speakersTwo}}
        {{ if eq .Params.show true }}
          {{ $speakerLinks = $speakerLinks | append (printf "<a href='%s'>%s</a>" .RelPermalink .Params.name) }}
        {{ else }}
          {{ $speakerLinks = $speakerLinks | append (printf "%s" .Params.name) }}
        {{end}}
      {{end}}

<!-- This section looks for keynote speakers whose keynote parameter (Params.keynote) matches a given keynote code (.keynote) in config.yaml -->
      {{ $pagesKeynote := (where $pages "Params.keynote" "!=" nil) }} 
      {{ $bridgeKeynote := (where $pages "Params.keynote" .keynote) }}
      {{ $speakersKeynote := (where $bridgeKeynote "Params.moderator" "!=" true) }}
      {{ range $speakersKeynote}}
        {{ if eq .Params.show true }}
          {{ $speakerLinks = $speakerLinks | append (printf "<a href='%s'>%s</a>" .RelPermalink .Params.name) }}
        {{ else }}
          {{ $speakerLinks = $speakerLinks | append (printf "%s" .Params.name) }}
        {{end}}
      {{end}}

      {{ partial "schedule_slot" (dict "root" $.root "event" . "speakerLinks" $.speakerLinks "pan" $.pan) }}
    
    {{end}}
  </div>
</div>
